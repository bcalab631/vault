| **Test Case ID** | **Test Case Title**                                           | **Objective**                                                        | **Steps**                                                                                                                                                               | **Expected Result**                                                                                                                                                                        |
|------------------|---------------------------------------------------------------|----------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| TC-01            | Verify Vault Kubernetes Authentication Method Configuration   | Ensure Kubernetes authentication method is enabled and configured in Vault. | 1. Enable Kubernetes authentication in Vault: `vault auth enable kubernetes`.<br>2. Configure the Kubernetes authentication method using the Kubernetes API server URL and JWT.<br>3. Verify that the authentication method is successfully configured. | Kubernetes authentication should be enabled and configured correctly in Vault. |
| TC-02            | Verify Kubernetes Authentication with Vault Service Account   | Ensure that Vault authenticates successfully using a Kubernetes service account. | 1. Create a Kubernetes service account.<br>2. Bind the service account to a Vault role.<br>3. Configure Vault CSI driver to authenticate using this service account.<br>4. Verify that Vault accepts the service account for authentication. | Vault should authenticate successfully using the Kubernetes service account. |
| TC-03            | Verify Vault Role Configuration for Kubernetes Authentication | Ensure the Vault role is configured correctly to allow Kubernetes authentication. | 1. Create a Vault role that maps to the Kubernetes service account.<br>2. Define policies for the role.<br>3. Verify the role is applied to the service account correctly. | The Vault role should be configured to map the Kubernetes service account with the correct policies. |
| TC-04            | Verify Authentication Token Generation from Kubernetes Service Account | Test that Vault generates an authentication token for the Kubernetes service account. | 1. Configure the Kubernetes service account with the correct Vault role.<br>2. Attempt authentication using the service account.<br>3. Verify that Vault generates a valid token. | Vault should generate a valid token for the Kubernetes service account. |
| TC-05            | Verify Vault Authentication via Kubernetes JWT Token         | Ensure that Vault can authenticate using a Kubernetes JWT token.       | 1. Create a Kubernetes service account.<br>2. Extract the JWT token from the Kubernetes service account.<br>3. Authenticate using `vault login -method=kubernetes` with the JWT token.<br>4. Verify that Vault accepts the token. | Vault should authenticate successfully using the Kubernetes JWT token. |
| TC-06            | Verify Vault Authentication with Kubernetes Role and Policy   | Test that the Vault authentication works with specific Kubernetes role-based policies. | 1. Define a policy for the Vault role.<br>2. Attach the policy to the Kubernetes service account.<br>3. Authenticate using `vault login -method=kubernetes`.<br>4. Verify that the service account has access to the defined secrets based on the policy. | Vault should authenticate the service account and grant access based on the assigned policy. |
| TC-07            | Verify Vault Role and Policy Access Control                   | Ensure that Vault policies enforce appropriate access control for Kubernetes service accounts. | 1. Create a Vault policy that restricts access to specific resources.<br>2. Bind the policy to a Kubernetes role.<br>3. Test access to the resource using the Kubernetes service account.<br>4. Verify that access control is enforced. | Vault should enforce access control policies and restrict access as per the defined role. |
| TC-08            | Verify Vault Authentication Using Kubernetes API Server URL   | Ensure that Vault uses the Kubernetes API server URL for authentication configuration. | 1. Check the configuration of the Vault Kubernetes authentication method.<br>2. Ensure that the Kubernetes API server URL is configured correctly.<br>3. Verify that authentication works using the configured URL. | Vault should use the correct Kubernetes API server URL for authentication configuration. |
| TC-09            | Verify Authentication Token Expiry Behavior                  | Test that the authentication token from Vault expires as per the defined TTL. | 1. Authenticate using Kubernetes authentication.<br>2. Check the TTL of the token using `vault token lookup`.<br>3. Wait for the token to expire.<br>4. Attempt to access Vault with the expired token. | The token should expire after the defined TTL, and Vault should deny access once expired. |
| TC-10            | Verify Vault Authentication Token Renewal                    | Test that the authentication token can be renewed.                   | 1. Authenticate using Kubernetes authentication.<br>2. Check the TTL of the token.<br>3. Renew the token using `vault token renew`.<br>4. Verify that the token is renewed and TTL is extended. | Vault should allow the token to be renewed and extend its TTL. |
| TC-11            | Verify Kubernetes Authentication with Service Account Tokens in Different Namespaces | Ensure Vault authenticates using service account tokens in different Kubernetes namespaces. | 1. Create a Kubernetes service account in different namespaces.<br>2. Define Vault roles and policies for each namespace.<br>3. Test authentication using tokens from service accounts in different namespaces. | Vault should authenticate successfully using service account tokens from different namespaces. |
| TC-12            | Verify Vault Role Binding to Specific Kubernetes Namespaces   | Ensure that the Vault role is properly bound to specific Kubernetes namespaces for authentication. | 1. Create a Vault role that is restricted to specific namespaces.<br>2. Bind the role to a Kubernetes service account.<br>3. Test authentication and verify that only the designated namespaces are allowed access. | Vault should only allow authentication for service accounts from the designated namespaces. |
| TC-13            | Verify Vault Authentication Logs for Kubernetes Auth Method   | Ensure that Vault logs contain accurate information about Kubernetes authentication events. | 1. Authenticate using a Kubernetes service account.<br>2. Inspect Vault logs for authentication events.<br>3. Verify that the logs contain correct authentication information (e.g., service account, namespace). | Vault logs should reflect accurate authentication events with details on the service account and namespace. |
| TC-14            | Verify Vault Kubernetes Authentication Across Multiple Clusters | Ensure Vault can authenticate Kubernetes service accounts across different clusters. | 1. Set up multiple Kubernetes clusters.<br>2. Configure Vault to authenticate using service accounts from multiple clusters.<br>3. Test authentication across clusters. | Vault should allow successful authentication from Kubernetes clusters configured for access. |
