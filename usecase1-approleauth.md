| **Test Case ID** | **Test Case Title**                                               | **Objective**                                                         | **Steps**                                                                                                                                                           | **Expected Result**                                                                                                                                                                            |
|------------------|-------------------------------------------------------------------|-----------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| TC-01            | Verify Vault AppRole Authentication Method Configuration           | Ensure AppRole authentication method is enabled and configured in Vault. | 1. Enable the AppRole authentication method: `vault auth enable approle`.<br>2. Configure the AppRole with a role ID and secret ID.<br>3. Verify that the AppRole method is successfully enabled and configured. | AppRole authentication should be enabled and configured correctly in Vault. |
| TC-02            | Verify Vault AppRole Secret ID and Role ID Configuration           | Ensure that Vault AppRole has the correct role ID and secret ID configuration. | 1. Create a new AppRole with `vault write auth/approle/role/<role_name> <role_configuration>`.<br>2. Retrieve the role ID and secret ID.<br>3. Verify that they are correctly configured. | Role ID and secret ID should be generated and configured correctly for the AppRole. |
| TC-03            | Verify AppRole Authentication Using Role ID and Secret ID         | Test authentication using a valid AppRole role ID and secret ID.       | 1. Generate the role ID and secret ID using `vault read auth/approle/role/<role_name>/role-id` and `vault read auth/approle/role/<role_name>/secret-id`.<br>2. Use `vault login` to authenticate using the role ID and secret ID.<br>3. Verify that Vault accepts the authentication. | Vault should authenticate successfully using the AppRole's role ID and secret ID. |
| TC-04            | Verify AppRole Authentication Failure with Invalid Secret ID     | Test that Vault denies authentication with an invalid secret ID.      | 1. Use a valid role ID and an invalid secret ID.<br>2. Attempt to authenticate with `vault login`.<br>3. Verify that Vault rejects the authentication. | Vault should reject authentication with an invalid secret ID. |
| TC-05            | Verify AppRole Authentication Failure with Invalid Role ID       | Test that Vault denies authentication with an invalid role ID.        | 1. Use an invalid role ID and a valid secret ID.<br>2. Attempt to authenticate with `vault login`.<br>3. Verify that Vault rejects the authentication. | Vault should reject authentication with an invalid role ID. |
| TC-06            | Verify AppRole Authentication with TTL and Secret ID Expiry      | Ensure that the AppRole authentication token expires after the TTL and secret ID expiry. | 1. Authenticate using AppRole with a valid role ID and secret ID.<br>2. Set a TTL for the token.<br>3. Wait for the token to expire.<br>4. Attempt to use the expired token.<br>5. Verify that Vault denies access. | The token should expire after the TTL and secret ID expiry, and Vault should deny access after expiry. |
| TC-07            | Verify AppRole Role ID and Secret ID Regeneration                | Ensure that a new secret ID can be generated after expiry or rotation. | 1. Generate a secret ID using `vault write auth/approle/role/<role_name>/secret-id`.<br>2. Attempt to authenticate.<br>3. Regenerate the secret ID using `vault write auth/approle/role/<role_name>/secret-id`.<br>4. Verify that the new secret ID is valid for authentication. | Vault should regenerate a new secret ID, and authentication should be successful using the new secret ID. |
| TC-08            | Verify AppRole Authentication Token Renewal                     | Ensure that AppRole authentication token can be renewed.             | 1. Authenticate using AppRole with valid role ID and secret ID.<br>2. Use `vault token renew` to renew the token.<br>3. Verify that the token TTL is extended and the renewal is successful. | The token should be renewed, and its TTL should be extended successfully. |
| TC-09            | Verify AppRole Access Control Based on Policies                  | Ensure that Vault access is restricted according to policies attached to the AppRole. | 1. Create a policy in Vault that restricts access to certain secrets.<br>2. Attach the policy to the AppRole.<br>3. Attempt to access secrets according to the policy.<br>4. Verify that Vault enforces the access control. | Vault should enforce the policies and restrict access to secrets as specified. |
| TC-10            | Verify AppRole Authentication Logs for Access Attempts          | Ensure that Vault logs contain accurate information about AppRole authentication attempts. | 1. Authenticate using AppRole with valid role ID and secret ID.<br>2. Inspect the Vault logs for authentication events.<br>3. Verify that the logs contain accurate authentication details. | Vault logs should contain accurate details of the AppRole authentication attempts, including the role ID. |
| TC-11            | Verify AppRole Authentication from Multiple Clients             | Test that multiple clients can authenticate using the same AppRole credentials. | 1. Generate the role ID and secret ID for the AppRole.<br>2. Authenticate from two different clients using the same credentials.<br>3. Verify that both clients can authenticate successfully. | Both clients should authenticate successfully using the same AppRole credentials. |
| TC-12            | Verify AppRole Authentication Across Multiple Applications      | Ensure that the same AppRole credentials can be used across different applications. | 1. Generate the role ID and secret ID.<br>2. Configure different applications to authenticate with the same AppRole credentials.<br>3. Verify that all applications can authenticate successfully. | All applications should be able to authenticate using the same AppRole credentials. |
| TC-13            | Verify AppRole Authentication with Custom Metadata               | Ensure that custom metadata is correctly configured and passed during AppRole authentication. | 1. Create an AppRole with custom metadata (e.g., `vault write auth/approle/role/<role_name> metadata=<metadata>`).<br>2. Authenticate using the role ID and secret ID.<br>3. Verify that the custom metadata is correctly assigned. | Custom metadata should be correctly passed during the authentication process and visible in the role details. |
| TC-14            | Verify AppRole Authentication with Access to Multiple Secrets  | Ensure that AppRole credentials grant access to multiple secrets based on policies. | 1. Create an AppRole with multiple policies that grant access to different secrets.<br>2. Authenticate using the AppRole credentials.<br>3. Verify that the secrets defined in the policies are accessible. | The AppRole should grant access to all secrets as defined in the attached policies. |
| TC-15            | Verify AppRole Access to Vault Secret via Vault CSI Driver      | Ensure that the Vault CSI driver can mount secrets after authenticating using AppRole. | 1. Configure Vault CSI to authenticate using AppRole credentials.<br>2. Mount the Vault secret into a Kubernetes Pod.<br>3. Verify that the secret is available in the Pod. | The secret should be available in the Pod after successful authentication using AppRole credentials. |
